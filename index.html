<!DOCTYPE html>
<html>
<head>
  <title>Genesys Client App â€“ Alerting Demo</title>

  <link rel="stylesheet"
        href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet"
        href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">

  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script src="https://sdk-cdn.mypurecloud.com/client-apps/2.6.3/purecloud-client-app-sdk-de77761d.min.js"></script>

  <style>
    body { margin-left: 20px; }
    fieldset { margin-top: 30px; }
  </style>
</head>

<body>
<h1>Alerting API Demo</h1>

<form class="form-horizontal container-fluid" id="toastForm">
  <div class="form-group">
    <label class="col-sm-1 control-label">Title</label>
    <div class="col-sm-11">
      <input id="title" class="form-control">
    </div>
  </div>

  <div class="form-group">
    <label class="col-sm-1 control-label">Message</label>
    <div class="col-sm-11">
      <textarea id="message" class="form-control" rows="3"></textarea>
    </div>
  </div>

  <div class="form-group">
    <label class="col-sm-1 control-label">Type</label>
    <div class="col-sm-11">
      <select id="toastType" class="form-control">
        <option value="info">Info</option>
        <option value="success">Success</option>
        <option value="error">Error</option>
      </select>
    </div>
  </div>

  <div class="form-group">
    <div class="col-sm-offset-1 col-sm-11">
      <button class="btn btn-primary" type="submit">Send Toast</button>
    </div>
  </div>
</form>

<hr>

<h3>Attention Control</h3>
<button class="btn btn-info" id="incAttention">Increase</button>
<button class="btn btn-warning" id="clearAttention">Clear</button>

<hr>

<h3>Open Window</h3>
<input id="targetURL" class="form-control"
       placeholder="https://en.wikipedia.org/wiki/Main_Page">
<br>
<button class="btn btn-default" id="openWindow">Open</button>

<script>
  $(function () {
    let clientApp;
    let attentionCount = 0;

    /* ----------------------------
       Client App Initialization
    ----------------------------- */
    function initClientApp() {
      clientApp = new window.purecloud.apps.ClientApp();

      clientApp.on('app:ready', () => {
        console.log('Client App READY');
      });

      clientApp.on('app:error', (err) => {
        console.error('Client App ERROR', err);
      });
    }

    initClientApp();

    /* ----------------------------
       Toast (Alerting API)
    ----------------------------- */
    $('#toastForm').on('submit', function (e) {
      e.preventDefault();

      const title = $('#title').val();
      const message = $('#message').val();
      const type = $('#toastType').val();

      if (!title || !message) return;

      clientApp.alerting.showToastPopup(
        title,
        message,
        {
          type,
          timeout: 5,
          showCloseButton: type === 'error'
        }
      );
    });

    /* ----------------------------
       Attention Count
    ----------------------------- */
    $('#incAttention').on('click', function () {
      attentionCount++;
      clientApp.alerting.setAttentionCount(attentionCount);
    });

    $('#clearAttention').on('click', function () {
      attentionCount = 0;
      clientApp.alerting.setAttentionCount(0);
    });

    /* ----------------------------
       Core UI
    ----------------------------- */
    $('#openWindow').on('click', function () {
      const url = $('#targetURL').val();
      if (url) {
        clientApp.coreUi.openWindow(url);
      }
    });
  });
</script>
</body>
</html>
